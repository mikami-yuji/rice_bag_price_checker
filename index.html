<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>米袋価格メリット計算ツール</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <h1>米袋価格メリット計算ツール</h1>

    <div class="main-layout">
        <div class="container">
            <div class="input-section">
                <h3>袋の情報</h3>
                <div class="input-grid">
                    <div class="input-group">
                        <label>袋の種類</label>
                        <div style="display: flex; align-items: center; gap: 15px; padding-top: 5px;">
                            <input type="radio" id="bagTypeSingle" name="bagType" value="single">
                            <label for="bagTypeSingle" style="font-weight: normal; margin-bottom: 0;">単袋</label>
                            <input type="radio" id="bagTypeRoll" name="bagType" value="roll" checked>
                            <label for="bagTypeRoll" style="font-weight: normal; margin-bottom: 0;">ロール袋</label>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="bagSize">米袋のキロ数</label>
                        <select id="bagSize">
                            <option value="280">1kg (280mm)</option>
                            <option value="320">1.4kg (320mm)</option>
                            <option value="320">1.5kg (320mm)</option>
                            <option value="350">2kg (350mm)</option>
                            <option value="400">3kg (400mm)</option>
                            <option value="450">4kg (450mm)</option>
                            <option value="470" selected>5kg (470mm)</option>
                            <option value="530">8kg (530mm)</option>
                            <option value="570">10kg (570mm)</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>袋の長さ</label>
                        <div style="display: flex; align-items: center; gap: 15px; padding-top: 5px;">
                            <input type="radio" id="lengthTypeNormal" name="bagLengthType" value="normal" checked>
                            <label for="lengthTypeNormal" style="font-weight: normal; margin-bottom: 0;">通常</label>
                            <input type="radio" id="lengthTypeEco" name="bagLengthType" value="eco">
                            <label for="lengthTypeEco" style="font-weight: normal; margin-bottom: 0;" title="選択すると、米袋の長さが30mm短くなります。">エコ（-30mm）</label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-section">
                <h3>価格関係</h3>
                <div class="input-grid price-layout">
                    <div class="price-column">
                        <h4>現行品</h4>
                        <div class="input-group">
                            <label for="currentPrice">単価（円）</label>
                            <input type="number" id="currentPrice" placeholder="単価：現行品">
                        </div>
                    </div>
                    <div class="price-column">
                        <h4>ご提案の米袋</h4>
                        <div class="input-group">
                            <label for="newBagPrice">単価（円）</label>
                            <input type="number" id="newBagPrice" placeholder="単価：ご提案の米袋">
                        </div>
                        <div class="input-group">
                            <label for="newBagCost">原価（円）</label>
                            <input type="number" id="newBagCost" placeholder="原価：ご提案の米袋">
                        </div>
                    </div>
                    <div class="price-column">
                        <h4>製版代</h4>
                        <div class="input-group">
                            <label for="plateCost">単価（円/版）</label>
                            <input type="number" id="plateCost" placeholder="製版代の単価">
                        </div>
                        <div class="input-group">
                            <label for="plateCostPrice">原価（円/版）</label>
                            <input type="number" id="plateCostPrice" placeholder="製版代の原価">
                        </div>
                        <div class="input-group">
                            <label for="plateCount">製版数</label>
                            <select id="plateCount">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-section">
                <h3>数量関係</h3>
                <div class="input-grid">
                    <div class="input-group">
                        <label for="annualUsage">年間使用量 <span class="unit-spec">(m数で記載)</span></label>
                        <div class="stepper">
                            <button type="button" onclick="decrementAnnualUsage()">-</button>
                            <input type="number" id="annualUsage" value="4000" readonly>
                            <button type="button" onclick="incrementAnnualUsage()">+</button>
                        </div>
                    </div>
                    <div class="input-group">
                        <label for="orderVolumeMeters">1回の発注m数</label>
                        <div class="stepper">
                            <button type="button" onclick="decrementOrderVolume()">-</button>
                            <input type="number" id="orderVolumeMeters" value="4000" readonly>
                            <button type="button" onclick="incrementOrderVolume()">+</button>
                        </div>
                    </div>
                </div>
            </div>
            <button type="button" class="reset-button" onclick="resetForm()">リセット</button>
        </div>

        <div id="results" class="results" style="display: none;">
            <div id="recoveryCheck"></div>
            <h3>計算結果</h3>
            <div id="result-output"></div>
            <button id="downloadButton" onclick="downloadForExcel()">Excel形式でダウンロード</button>
            
            <h3>回収シミュレーション（発注回数別累計メリット）</h3>
            <pre id="simulationTable"></pre>
        </div>
    </div>

    <script src="script.js"></script>
    <div id="footer-branding">
        <p>提供：</p>
        <a href="https://www.asahipac.co.jp/" target="_blank" rel="noopener noreferrer">
            <img src="https://www.asahipac.co.jp/cms/wp-content/themes/asahipac/images/logo.png" alt="Asahipac Logo" class="asahipac-logo">
        </a>
    </div>
</body>
</html>